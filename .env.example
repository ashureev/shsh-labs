# =============================================================
# SHSH Playground — Environment Configuration
# =============================================================
# Copy this file: cp .env.example .env
#
# NOTE: AI features are OPTIONAL. The terminal works without any API keys.
#       Set GOOGLE_API_KEY only if you want the AI mentor feature.

# ─── AI Features (Optional) ──────────────────────────────────

# Get a free API key: https://aistudio.google.com/apikey
# Leave empty to disable AI and run terminal-only mode.
GOOGLE_API_KEY=

# AI Provider Settings (only used when GOOGLE_API_KEY is set)
LLM_PROVIDER=gemini
LLM_MODEL=gemini-2.5-flash-lite-preview-06-2025

# ─── Core Application ─────────────────────────────────────────

# Server
PORT=8080
DB_PATH=./data/playground.db

# Python Agent Service (gRPC)
PYTHON_AGENT_ADDR=python-agent:50051

# Redis (session storage)
REDIS_URL=redis:6379

# Conversation logging (default-on transparency logs)
CONVERSATION_LOG_ENABLED=true
CONVERSATION_LOG_DIR=./data/logs/conversations
CONVERSATION_LOG_GLOBAL_ENABLED=false
CONVERSATION_LOG_GLOBAL_PATH=./data/logs/conversations/all.ndjson
CONVERSATION_LOG_QUEUE_SIZE=1000

# Container runtime: "" = standard Docker, "runsc" = gVisor
CONTAINER_RUNTIME=

# ─── Container Timeouts ─────────────────────────────────────

# Container stop timeout (default: 10s)
SHSH_CONTAINER_STOP_TIMEOUT=10s

# Container create timeout (default: 2m)
SHSH_CONTAINER_CREATE_TIMEOUT=2m

# Health check database timeout (default: 5s)
SHSH_HEALTH_CHECK_TIMEOUT=5s

# Background destroy cleanup timeout (default: 30s)
SHSH_DESTROY_CLEANUP_TIMEOUT=30s

# TTL worker cleanup interval (default: 5m)
SHSH_TTL_WORKER_INTERVAL=5m

# ─── Container Resource Limits ──────────────────────────────

# Memory limit per container in bytes (default: 536870912 = 512MB)
SHSH_CONTAINER_MEMORY_LIMIT=536870912

# CPU quota per container (default: 50000 = 0.5 CPU)
SHSH_CONTAINER_CPU_QUOTA=50000

# PIDs limit per container (default: 256)
SHSH_CONTAINER_PIDS_LIMIT=256

# ─── Container Retry Settings ───────────────────────────────

# Container create retry attempts (default: 20)
SHSH_CONTAINER_CREATE_RETRY_ATTEMPTS=20

# Delay between container create retries (default: 250ms)
SHSH_CONTAINER_CREATE_RETRY_DELAY=250ms

# ─── Rate Limiting ──────────────────────────────────────────

# Max requests per rate limit window (default: 10)
SHSH_RATE_LIMIT_REQUESTS=10

# Rate limit window duration (default: 1m)
SHSH_RATE_LIMIT_WINDOW=1m

# ─── SSE Settings ───────────────────────────────────────────

# Max request body size for SSE endpoints in bytes (default: 1048576 = 1MB)
SHSH_SSE_MAX_BODY_SIZE=1048576

# SSE retry delay for client reconnection (default: 5s)
SHSH_SSE_RETRY_DELAY=5s

# SSE keepalive interval (default: 10s)
SHSH_SSE_KEEPALIVE_INTERVAL=10s

# ─── Database Retry Settings ────────────────────────────────

# Max database retry attempts for SQLITE_BUSY (default: 3)
SHSH_DB_MAX_RETRIES=3

# Base delay for database retries (default: 50ms)
SHSH_DB_RETRY_BASE_DELAY=50ms
