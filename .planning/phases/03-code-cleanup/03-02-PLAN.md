---
phase: 03-code-cleanup
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - internal/agent/helpers.go
  - internal/api/handler.go
  - internal/config/config.go
autonomous: true
requirements:
  - CLEAN-01
  - CLEAN-04
must_haves:
  truths:
    - No unused imports remain in any Go file
    - Empty placeholder files are removed
    - Dead code is identified and removed
    - isDevelopment logic is consolidated (not duplicated)
  artifacts:
    - path: internal/agent/helpers.go
      provides: Removed (was empty placeholder)
      state: "deleted"
    - path: internal/api/handler.go
      provides: Handler utilities without unused code
      pattern: "isDevelopment"
    - path: internal/config/config.go
      provides: Centralized IsDevelopment method
      exports: ["IsDevelopment"]
  key_links:
    - from: internal/api/handler.go
      to: internal/config/config.go
      via: "config.IsDevelopment()"
      pattern: "cfg\\.IsDevelopment|config\\.IsDevelopment"
---

<objective>
Remove dead code and unused imports across the codebase.

Purpose: Clean up empty files, unused code paths, and consolidate duplicated logic.
Output: Cleaner codebase with no unused imports or dead code.
</objective>

<execution_context>
@/home/ashu/.claude/get-shit-done/workflows/execute-plan.md
@/home/ashu/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@/home/ashu/Downloads/mycodes/shsh-labs/internal/agent/helpers.go
@/home/ashu/Downloads/mycodes/shsh-labs/internal/api/handler.go
@/home/ashu/Downloads/mycodes/shsh-labs/internal/config/config.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove empty helpers.go file</name>
  <files>internal/agent/helpers.go</files>
  <action>
    Delete the internal/agent/helpers.go file. The file contains only a comment stating it is preserved for future use but currently has no actual code. This is dead code that should be removed.

    Before deleting, verify the file is not imported anywhere:
    - Check if any file imports "github.com/ashureev/shsh-labs/internal/agent/helpers"
    - If imported, the import must be removed first

    The file comment states: "This file is currently empty as all previous helper functions were unused."
  </action>
  <verify>grep -r "helpers" internal/agent/*.go | grep -v "_test.go" to confirm no imports</verify>
  <done>internal/agent/helpers.go is deleted and no build errors occur</done>
</task>

<task type="auto">
  <name>Task 2: Consolidate isDevelopment logic</name>
  <files>internal/api/handler.go</files>
  <action>
    The isDevelopment() method in internal/api/handler.go duplicates logic that exists in internal/config/config.go's IsDevelopment() method.

    Current handler.go code (lines 47-57):
    ```go
    func (h *Handler) isDevelopment() bool {
        if env := os.Getenv("APP_ENV"); env != "" {
            return env == "development"
        }
        // Fallback to URL detection for now
        return h.frontendRedirectURL == "" ||
            h.frontendRedirectURL == "/dashboard" ||
            strings.Contains(h.frontendRedirectURL, "localhost") ||
            strings.Contains(h.frontendRedirectURL, "127.0.0.1")
    }
    ```

    The config.go version (lines 149-154) is cleaner and more authoritative:
    ```go
    func (c *Config) IsDevelopment() bool {
        return c.FrontendURL == "" ||
            strings.Contains(c.FrontendURL, "localhost") ||
            strings.Contains(c.FrontendURL, "127.0.0.1")
    }
    ```

    Since Handler has access to config via container.Manager or can receive cfg, refactor to use the centralized config.IsDevelopment().

    Options:
    1. Add config to Handler struct and use cfg.IsDevelopment()
    2. Remove the method entirely if not used

    First, check if isDevelopment() is actually called anywhere in the codebase.
  </action>
  <verify>grep -r "isDevelopment()" --include="*.go" . to find usages</verify>
  <done>isDevelopment() is either removed (if unused) or refactored to use config.IsDevelopment()</done>
</task>

<task type="auto">
  <name>Task 3: Verify no unused imports remain</name>
  <files>All Go files</files>
  <action>
    Run golangci-lint with unused import detection to verify no unused imports exist:

    ```bash
    golangci-lint run --enable-only=unused ./...
    ```

    Also run goimports to auto-fix any import issues:
    ```bash
    goimports -w .
    ```

    If any unused imports are found, remove them.
  </action>
  <verify>golangci-lint run --enable-only=unused ./... returns 0 issues</verify>
  <done>No unused imports detected by golangci-lint</done>
</task>

</tasks>

<verification>
Run full lint check:
```bash
golangci-lint run ./...
```

Run full test suite:
```bash
go test ./...
```

Verify builds:
```bash
go build ./...
```
</verification>

<success_criteria>
- internal/agent/helpers.go is deleted
- isDevelopment() is either removed or uses config.IsDevelopment()
- golangci-lint reports 0 unused import issues
- All builds pass: go build ./...
- All tests pass: go test ./...
</success_criteria>

<output>
After completion, create `.planning/phases/03-code-cleanup/03-02-SUMMARY.md`
</output>
